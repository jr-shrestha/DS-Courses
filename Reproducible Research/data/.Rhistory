mean(df[order(df$INJURIES, decreasing=TRUE),],30)[,c(7,8,24,38)]
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],20)[,c(7,8,23,38)]
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],20)[,c(7,8,24,38)]
head(type[order(type[,2], decreasing=TRUE),],10)
head(type[order(type[,2], decreasing=TRUE),],30)
head(dffat)
mean
strmean
?mean
mean(dffat)
summary(dffat)
summary(df[7,8,23,24])
summary(df[,c(7,8,23,24)])
summary(df[,c(7,8,23,24)])[1]
summary(df[,c(7,8,23,24)])[2]
summary(df[,c(7,8,23,24)],10)
summary(df[,c(7,8,23,24)],20)
summary(df[,c(7,8,23,24,38)],10)
ll<-df
ll[subset(ll, ll$EVTYPE==HAIL),]
ll[subset(ll, ll$EVTYPE=="HAIL"),]
ll[!subset(ll, ll$EVTYPE=="HAIL"),]<- "other"
head(ll)
ll<-df
ll[!subset(ll, ll$EVTYPE=="HAIL"),8]<- "other"
subset(ll, ll$EVTYPE=="HAIL")
head(subset(ll, ll$EVTYPE=="HAIL"))
head(subset(ll, ll$EVTYPE=="HAIL" & ll$FATALITIES >= 0))[,c(7,8,23,38)]
head(subset(ll, ll$EVTYPE=="HAIL" & ll$FATALITIES != 0))[,c(7,8,23,38)]
nrow(subset(ll, ll$EVTYPE=="HAIL" & ll$FATALITIES != 0))[,c(7,8,23,38)]
nrows(subset(ll, ll$EVTYPE=="HAIL" & ll$FATALITIES != 0))[,c(7,8,23,38)]
ll<-subset(ll, ll$EVTYPE=="HAIL" & ll$FATALITIES != 0)[,c(7,8,23,38)]
ll
summary(df[,c(7,8,23,24)],20)
for (i in 1:length(types))
{
sumdf$EVTYPE[i]=types[i]
sumdf$FATALITIES[i]=sum(df$FATALITIES[df$EVTYPE==types[i]])
sumdf$INJURIES[i]=sum(df$INJURIES[df$EVTYPE==types[i]])
}
type <- unique(data$EVTYPE)
types <- unique(df$EVTYPE)
for (i in 1:length(types))
{
sumdf$EVTYPE[i]=types[i]
sumdf$FATALITIES[i]=sum(df$FATALITIES[df$EVTYPE==types[i]])
sumdf$INJURIES[i]=sum(df$INJURIES[df$EVTYPE==types[i]])
}
sumdf <- Null
for (i in 1:length(types))
{
sumdf$EVTYPE[i]=types[i]
sumdf$FATALITIES[i]=sum(df$FATALITIES[df$EVTYPE==types[i]])
sumdf$INJURIES[i]=sum(df$INJURIES[df$EVTYPE==types[i]])
}
sumdf <- NULL
for (i in 1:length(types))
{
sumdf$EVTYPE[i]=types[i]
sumdf$FATALITIES[i]=sum(df$FATALITIES[df$EVTYPE==types[i]])
sumdf$INJURIES[i]=sum(df$INJURIES[df$EVTYPE==types[i]])
}
head(sumdf)
sumdf<-as.data.frame(sumdf)
head(sumdf)
types
sumdf <- NULL
types <- unique(df$EVTYPE)
for (i in 1:length(types))
{
sumdf$EVTYPE[i]=types[i]
sumdf$FATALITIES[i]=sum(df$FATALITIES[df$EVTYPE==types[i]])
sumdf$INJURIES[i]=sum(df$INJURIES[df$EVTYPE==types[i]])
}
sumdf<-as.data.frame(sumdf)
head(sumdf)
data<- read.csv(bzfile("./data.bz2"),stringsAsFactors = FALSE)
Events <-unique(data$EVTYPE)
dataProc<-NULL
# Create Dataset
for (i in 1:length(Events))
{
dataProc$event[i]=Events[i]
dataProc$fatalities[i]=sum(data$FATALITIES[data$EVTYPE==Events[i]])
dataProc$injuries[i]=sum(data$INJURIES[data$EVTYPE==Events[i]])
dataProc$pDMG[i]=sum(data$totalPropDamage[data$EVTYPE==Events[i]])
dataProc$cDMG[i]=sum(data$totalCropDamage[data$EVTYPE==Events[i]])
}
dataProc<-as.data.frame(dataProc) # List to Dataframe
head(dataProc) # Brief review of the dataset
data <- read.csv("repdata-data-StormData.csv")
Events <-unique(data$EVTYPE)
dataProc<-NULL
# Create Dataset
for (i in 1:length(Events))
{
dataProc$event[i]=Events[i]
dataProc$fatalities[i]=sum(data$FATALITIES[data$EVTYPE==Events[i]])
dataProc$injuries[i]=sum(data$INJURIES[data$EVTYPE==Events[i]])
dataProc$pDMG[i]=sum(data$totalPropDamage[data$EVTYPE==Events[i]])
dataProc$cDMG[i]=sum(data$totalCropDamage[data$EVTYPE==Events[i]])
}
dataProc<-as.data.frame(dataProc) # List to Dataframe
head(dataProc) # Brief review of the dataset
rm(data)
rm(dataProc)
rm(typeinj)
rm(typefat)
View(type)
head(types)
types<-as.data.frame(types)
head(types)
types[1]
types[1,]
types[2,]
lenght(types)
length(types)
row(types)
for (i in 1:row(types))
{
sumdf$EVTYPE[i]=types[i]
sumdf$FATALITIES[i]=sum(df$FATALITIES[df$EVTYPE==types[i]])
sumdf$INJURIES[i]=sum(df$INJURIES[df$EVTYPE==types[i]])
}
sumdf<-as.data.frame(sumdf)
for (i in 1:nrow(types))
{
sumdf$EVTYPE[i]=types[i]
sumdf$FATALITIES[i]=sum(df$FATALITIES[df$EVTYPE==types[i]])
sumdf$INJURIES[i]=sum(df$INJURIES[df$EVTYPE==types[i]])
}
sumdf<-as.data.frame(sumdf)
dfinjsum <- aggregate(INJURIES ~ EVTYPE, data = df, sum, na.action = na.omit)
head(dfinjsum)
dfinjsum <- dfinjsum[dfinjsum$INJURIES, decreasing=TRUE),]
dfinjsum <- dfinjsum[order(dfinjsum$INJURIES, decreasing=TRUE),]
head(dfinjsum)
head(dfinj)
dffatsum <- aggregate(INJURIES ~ EVTYPE, data = df, sum, na.action = na.omit)
dffatsum <- dffatsum[order(dffatsum$FATALITIES, decreasing=TRUE),]
head(dffatsum)
dffatsum <- aggregate(FATALITIES ~ EVTYPE, data = df, sum, na.action = na.omit)
dffatsum <- dffatsum[order(dffatsum$FATALITIES, decreasing=TRUE),]
head(dffatsum)
head(dffat)
head(type)
type <- data.frame(table(StormData$EVTYPE))
head(type[order(type[,2], decreasing=TRUE),],20)
head(type,20)
ffatsum <- aggregate(FATALITIES ~ EVTYPE, data = df, sum, na.action = na.omit)
head(ffatsum)
head(ffatsum,20)
head(type,20)
rm(ffatsum)
type <- data.frame(table(StormData$EVTYPE))
dffatsum <- aggregate(FATALITIES ~ EVTYPE, data = df, sum, na.action = na.omit)
dfinjsum <- aggregate(INJURIES ~ EVTYPE, data = df, sum, na.action = na.omit)
rowbind(type, dffatsum$FATALITIES, dfinjsum$INJURIES)
rbind(type, dffatsum$FATALITIES, dfinjsum$INJURIES)
rowbind(type, dffatsum$FATALITIES
rbind(type, dffatsum$FATALITIES)
rbind(type, dffatsum)
cbind(type, dffatsum)
cbind(type, dffatsum$FATALITIES)
cbind(type, dffatsum$FATALITIES, dfinjsum$INJURIES)
dffs <- cbind(type, dffatsum$FATALITIES, dfinjsum$INJURIES)
colnames(dffs) <- c("EVTYPE", "FREQ", "FATALITIES", "INJURIES")
head(dffs)
dffs$FATMED <- dffs$FATALITIES / dffs$FREQ
head(dffs)
tail(dffs)
dffs$FATMED <- dffs$FATALITIES / dffs$FREQ
dffs$INJMED <- dffs$INJURIES / dffs$FREQ
tail(dffs)
FATMED <- head(dffs[order(dffs$FATMED, decreasing=TRUE),],20)
INJMED <- head(dffs[order(dffs$INJMED, decreasing=TRUE),],20)
FATMED
INJMED
FATMED <- head(dffs[order(dffs$FATMED, decreasing=TRUE),],20)[,c(1,5)]
INJMED <- head(dffs[order(dffs$INJMED, decreasing=TRUE),],20)[,c(1,6)]
INJMED
plot(INJMED)
plot(INJMED, type="l")
plot(INJMED, type="line")
barplot(INJMED)
library(ggplot2)
library(ggplot2)
p3 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 12, colour = "red"), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p3
p3 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") , axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p3
p3 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p3 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p3
p3 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities"))
p2 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p2
p2
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
pq
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange"), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab("Weather Events") + ylab("Injuries & Fatalities"))
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 45,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
pq
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 45,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 75,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 80,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 95,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "orange") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "light blue") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = FATMED))
p1
p1 <- ggplot(FATMED[1:20, ], aes(x = factor(EVTYPE, levels = EVTYPE, ordered = FALSE),
y = FATMED)) + geom_histogram(colour = "black", stat = "identity", fill = "light blue") +
theme(text = element_text(size = 19), axis.text.x = element_text(angle = 90,
vjust = 1)) + labs(title = "Top 20 disasters with most number of deaths per event") +
xlab(NULL) + ylab("Injuries & Fatalities") + geom_text(aes(label = NULL))
p1
ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge", aes(fill = FATMED)) + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Severe weather events and fatalities", x = "Meteological event",
y = "Fatalities", fill = "Fatalities")
ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge", aes(fill = FATMED)) + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Severe weather events and fatalities", x = "Meteological event",
y = "Fatalities")
ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge", theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Severe weather events and fatalities", x = "Meteological event",
y = "Fatalities")
ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge", theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Severe weather events and fatalities", x = "Meteological event",
y = "Fatalities")
ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Severe weather events and fatalities", x = "Meteological event",
y = "Fatalities")
ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge", fill = "light blue") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Severe weather events and fatalities", x = "Meteological event",
y = "Fatalities")
ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Severe weather events and fatalities", x = "Meteological event",
y = "Fatalities")
plot1 <- ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths per event",
x = "Meteological     event", y = "Fatalities")
plot2 <- ggplot(INJMED, aes(as.character(EVTYPE), INJMED)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries per event",
x = "Meteological event", y = "Fatalities")
grid.arrange(plot1, plot2, nrow = 2)
plot1 <- ggplot(FATMED, aes(as.character(EVTYPE), FATMED)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths per event",
x = "Meteological     event", y = "Number of Fatalities")
plot2 <- ggplot(INJMED, aes(as.character(EVTYPE), INJMED)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries per event",
x = NULL, y = "Number of Injuries")
grid.arrange(plot1, plot2, nrow = 2)
grid.arrange(plot1, plot2, ncol = 2)
FATALITIES <- head(dffs[order(dffs$FATALITIES, decreasing=TRUE),],20)[,c(1,3)]
INJURIES <- head(dffs[order(dffs$INJURIES, decreasing=TRUE),],20)[,c(1,3)]
plot1 <- ggplot(FATALITIES, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths",
x = "Meteological     event", y = "Number of Fatalities")
plot2 <- ggplot(INJURIES, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries",
x = NULL, y = "Number of Injuries")
grid.arrange(plot1, plot2, ncol = 2)
plot1
plot2
plot2 <- ggplot(INJURIES, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries",
x = "Meteological", y = "Number of Injuries")
plo2
plot2
FATALITIES <- head(dffs[order(dffs$FATALITIES, decreasing=TRUE),],20)[,c(1,2)]
plot1 <- ggplot(FATALITIES, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths",
x = "Meteological     event", y = "Number of Fatalities")
plot1
head(FATALITIES)
FATALITIES <- head(dffs[order(dffs$FATALITIES, decreasing=TRUE),],20)[,c(1,3)]
INJURIES <- head(dffs[order(dffs$INJURIES, decreasing=TRUE),],20)[,c(1,4)]
plot1 <- ggplot(FATALITIES, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths",
x = "Meteological     event", y = "Number of Fatalities")
plot2 <- ggplot(INJURIES, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries",
x = "Meteological", y = "Number of Injuries")
grid.arrange(plot1, plot2, ncol = 2)
subset(dffs, dffs$EVTYPE == "TORNADO")
dffat
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],20)[,c(8,23)]
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],20)[,c(8,24)]
dffat
plot5 <- ggplot(dffat, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths in each event",
x = NULL, y = "Number of Fatalities")
plot6 <- ggplot(dfinj, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries in each event",
x = NULL, y = "Number of Injuries")
grid.arrange(plot5, plot6, ncol = 2)
grid.arrange(plot5, plot6, nrow = 2)
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],20)[,c(8,23)]
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],20)[,c(8,24)]
dffat
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],40)[,c(8,23)]
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],40)[,c(8,24)]
plot5 <- ggplot(dffat, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths in each event",
x = NULL, y = "Number of Fatalities")
plot6 <- ggplot(dfinj, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries in each event",
x = NULL, y = "Number of Injuries")
grid.arrange(plot5, plot6, nrow = 2)
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],60)[,c(8,23)]
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],60)[,c(8,24)]
plot5 <- ggplot(dffat, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths in each event",
x = NULL, y = "Number of Fatalities")
plot6 <- ggplot(dfinj, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries in each event",
x = NULL, y = "Number of Injuries")
grid.arrange(plot5, plot6, nrow = 2)
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],70)[,c(8,24)]
plot5 <- ggplot(dffat, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths in each event",
x = NULL, y = "Number of Fatalities")
plot6 <- ggplot(dfinj, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries in each event",
x = NULL, y = "Number of Injuries")
grid.arrange(plot5, plot6, nrow = 2)
grid.arrange(plot5, plot6, ncol = 2)
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],40)[,c(8,23)]
plot5 <- ggplot(dffat, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths in each event",
x = NULL, y = "Number of Fatalities")
grid.arrange(plot5, plot6, ncol = 2)
grid.arrange(plot5, plot6, ncol = 2, title = "Most devastating disater of each type of event")
grid.arrange
grid.arrange(plot5, plot6, ncol = 2, main = "Most devastating disater of each type of event")
plot5 <- ggplot(dffat, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = NULL,
x = NULL, y = "Number of Fatalities")
plot6 <- ggplot(dfinj, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = NULL,
x = NULL, y = "Number of Injuries")
grid.arrange(plot5, plot6, ncol = 2, main = "Most devastating disater for the worst 7 types of events")
StormData <- read.csv("repdata-data-StormData.csv")
df <- within(StormData, datetime <- as.POSIXlt(BGN_DATE, format="%m/%d/%Y"))
summary(df[,c(7,8,23,24)],20)
str(type)
type <- data.frame(table(StormData$EVTYPE))
str(type)
dffatsum <- aggregate(FATALITIES ~ EVTYPE, data = df, sum, na.action = na.omit)
dfinjsum <- aggregate(INJURIES ~ EVTYPE, data = df, sum, na.action = na.omit)
dffs <- cbind(type, dffatsum$FATALITIES, dfinjsum$INJURIES)
colnames(dffs) <- c("EVTYPE", "FREQ", "FATALITIES", "INJURIES")
dffs$FATMED <- dffs$FATALITIES / dffs$FREQ
dffs$INJMED <- dffs$INJURIES / dffs$FREQ
FATALITIES <- head(dffs[order(dffs$FATALITIES, decreasing=TRUE),],20)[,c(1,3)]
INJURIES <- head(dffs[order(dffs$INJURIES, decreasing=TRUE),],20)[,c(1,4)]
FATMED <- head(dffs[order(dffs$FATMED, decreasing=TRUE),],20)[,c(1,5)]
INJMED <- head(dffs[order(dffs$INJMED, decreasing=TRUE),],20)[,c(1,6)]
head(FATMED)
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],40)[,c(8,23)]
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],70)[,c(8,24)]
head(dffat)
head(dffs[order(dffs$FREQ, decreasing=TRUE),],10)
head(dffs[order(dffs$FATALITIES, decreasing=TRUE),],10)
head(dffs[order(dffs$FATMED, decreasing=TRUE),],10)
head(dffs[order(dffs$INJMEAN, decreasing=TRUE),],10)
dffatsum <- aggregate(FATALITIES ~ EVTYPE, data = df, sum, na.action = na.omit)
dfinjsum <- aggregate(INJURIES ~ EVTYPE, data = df, sum, na.action = na.omit)
dffs <- cbind(type, dffatsum$FATALITIES, dfinjsum$INJURIES)
colnames(dffs) <- c("EVTYPE", "FREQ", "FATALITIES", "INJURIES")
dffs$FATMEAN <- dffs$FATALITIES / dffs$FREQ
dffs$INJMEAN <- dffs$INJURIES / dffs$FREQ
FATALITIES <- head(dffs[order(dffs$FATALITIES, decreasing=TRUE),],20)[,c(1,3)]
INJURIES <- head(dffs[order(dffs$INJURIES, decreasing=TRUE),],20)[,c(1,4)]
FATMEAN <- head(dffs[order(dffs$FATMEAN, decreasing=TRUE),],20)[,c(1,5)]
INJMEAN <- head(dffs[order(dffs$INJMEAN, decreasing=TRUE),],20)[,c(1,6)]
dffat <- head(df[order(df$FATALITIES, decreasing=TRUE),],40)[,c(8,23)]
dfinj <- head(df[order(df$INJURIES, decreasing=TRUE),],70)[,c(8,24)]
head(dffs[order(dffs$FATMEAN, decreasing=TRUE),],10)
head(dffs[order(dffs$INJMEAN, decreasing=TRUE),],10)
head(dffs[order(dffs$FATALITIES, decreasing=TRUE),],10)
plot3 <- ggplot(FATMEAN, aes(as.character(EVTYPE), FATMEAN)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths per event",
x = NULL, y = "Number of Fatalities")
plot4 <- ggplot(INJMEAN, aes(as.character(EVTYPE), INJMEAN)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries per event",
x = NULL, y = "Number of Injuries")
grid.arrange(plot3, plot4, ncol = 2)
plot1 <- ggplot(FATALITIES, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of deaths",
x = NULL, y = "Number of Fatalities")
plot2 <- ggplot(INJURIES, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = "Top 20 disasters with most number of injuries",
x = NULL, y = "Number of Injuries")
grid.arrange(plot1, plot2, ncol = 2)
subtype(dffs, dffs$EVTYPE == "Tornado")
subset(dffs, dffs$EVTYPE == "Tornado")
subset(dffs, dffs$EVTYPE == "TORNADO")
plot5 <- ggplot(dffat, aes(as.character(EVTYPE), FATALITIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = NULL,
x = NULL, y = "Number of Fatalities")
plot6 <- ggplot(dfinj, aes(as.character(EVTYPE), INJURIES)) + geom_bar(stat = "identity",
position = "dodge") + theme(axis.text.x = element_text(angle = 90)) +
labs(title = NULL,
x = NULL, y = "Number of Injuries")
grid.arrange(plot5, plot6, ncol = 2, main = "Most devastating disater for the worst 7 types of events")
rename
